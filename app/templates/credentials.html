<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fetch Data Example</title>

    <script>
        // This function will be executed when the page is fully loaded
        window.onload = function() {
            // Making a GET request to the backend server
            fetch('{{redirect_url}}credentials_list')
            .then(response => response.json()) // Parse the response as JSON
                .then(data => {
                    const credentials = data.credentialIDs;
                    const container = document.getElementById('response');

                    credentials.forEach(credential => {
                        // Create a new div for each credential
                        const credentialItem = document.createElement('div');
                        
                        // Make the div clickable
                        credentialItem.addEventListener('click', function() {
                            alert('Clicked: ' + credential);
                            fetch('{{redirect_url}}set_credentialId', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify({ credentialID: credential }),
                            }) // Example endpoint for demonstration
                            .then(response => console.log(response)) // Get the response as a string                
                            .catch(error => {
                                console.error('Error:', error);
                            });
                            window.location.href = "{{redirect_url}}select_pdf";
                            // Perform any action here, such as navigating to another page
                        });
                        
                        // Set the text content to the credential value
                        credentialItem.textContent = credential;

                        // Add some styling to make it clear it's clickable
                        credentialItem.style.cursor = 'pointer';
                        credentialItem.style.padding = '5px';
                        credentialItem.style.margin = '5px 0';
                        credentialItem.style.border = '1px solid #ccc';
                        credentialItem.style.borderRadius = '4px';
                        credentialItem.style.backgroundColor = '#f9f9f9';

                        // Append the div to the container
                        container.appendChild(credentialItem);
                    });
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                });
        };
    </script>
</head>
<body>
    <h1>Available Credentials</h1>
    
    <div id="response">Loading...</div>

</body>
</html>